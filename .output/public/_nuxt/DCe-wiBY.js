import{a as U,b as $,_ as j}from"./CFiBINGE.js";import{h as P,r as n,k as V,z as A,o as c,c as d,a as e,b as k,w as T,j as F,d as B,t as u,m as D,F as S,l as G}from"./CtvG9C47.js";import{u as K}from"./BPDisUHu.js";const M={class:"flex flex-col items-center bg-background h-screen py-10 px-5"},O={class:"bg-white p-6 rounded-lg shadow-lg w-full max-w-4xl text-black flex flex-col items-center my-auto"},J={class:"flex flex-col md:grid md:grid-cols-2 md:gap-x-10 w-full"},L={class:"flex flex-col mb-6 md:mb-0"},W=e("div",{class:"text-center mb-6"},[e("h1",{class:"text-2xl md:text-3xl font-semibold mb-2"}," User Profile "),e("p",null," Manage your profile information and upload photos. ")],-1),q={class:"space-y-6"},H=["src"],Q={key:0,class:"text-center mt-6"},X=e("label",{for:"file-upload",class:"block text-lg font-medium mb-2"}," Upload Photos: ",-1),Y={class:"bg-gray-100 p-4 rounded-lg shadow-inner"},Z=e("strong",null,"ID:",-1),ee=e("strong",null,"Username:",-1),te={class:"flex flex-col items-center mt-4"},se={class:"text-lg font-semibold mb-2"},ae={class:"text-md mb-2"},oe={class:"mt-4"},le={key:0,class:"text-center text-red-500"},ne={key:1,class:"text-center text-green-500"},re={class:"bg-gray-100 p-4 rounded-lg shadow-inner w-full my-auto h-[90vh] max-h-[40rem] overflow-y-auto"},ie=e("h2",{class:"text-xl text-center font-bold mb-4"}," RizzViews ",-1),ce={class:"space-y-4"},fe=P({__name:"index",async setup(de){let _,R;const E=K("passKey").value,m=n(1),r=n(null),p=n(1),x=n([]),b=n([]),i=n(null),z=n(!1),C=[];let w=0;const t=([_,R]=V(()=>$fetch(`/api/user/${E}`)),_=await _,R(),_);"data"in t&&(r.value=t.data.user,p.value=t.data.starRatingAverages[m.value-1]??0,x.value=t.data.imageIds??[],w=t.data.starRatingTotals[m.value-1]??0,b.value=t.data.comments[m.value-1]??[],x.value.forEach(o=>{var l;C.push(`/user-photos/${(l=r.value)==null?void 0:l.id}/id_${o}.webp`)})),A(m,o=>{"data"in t&&(p.value=t.data.starRatingAverages[o-1]??0,w=t.data.starRatingTotals[o-1]??0,b.value=t.data.comments[o-1]??[])});const I=async o=>{var f,g,v;const l=(f=o.target.files)==null?void 0:f[0];if(l&&((g=r.value)!=null&&g.id)){if(l.size>200*1024*1024){i.value="File size exceeds 200MB";return}const h=l.type;if(!["image/jpeg","image/png","image/webp"].includes(h)){i.value="Invalid file type. Only JPEG, PNG, and WEBP images are allowed.";return}const a=new FormData;a.append("image",l),a.append("userId",(v=r.value)==null?void 0:v.id);try{"message"in await $fetch("/api/upload",{method:"POST",body:a})&&(z.value=!0,setTimeout(()=>{window.location.reload()},500))}catch(s){s.response&&s.response._data?i.value=s.response._data.error||"An unknown error occurred":i.value="Failed to connect to the server. Please try again later."}}};return(o,l)=>{var h,y;const f=j,g=U,v=$;return c(),d("div",M,[e("div",O,[e("div",J,[e("div",L,[W,e("div",q,[k(g,{items:C,ui:{item:"basis-full",container:"rounded-lg",indicators:{wrapper:"relative bottom-0 mt-4"}},indicators:"",class:"w-full md:w-64 mx-auto"},{default:T(({item:a})=>[e("img",{src:a,class:"w-full",draggable:"false"},null,8,H)]),indicator:T(({onClick:a,page:s,active:N})=>[k(f,{label:String(s),variant:N?"solid":"outline",size:"2xs",class:"rounded-full min-w-6 justify-center",onClick:ue=>{m.value=s,a(s)}},null,8,["label","variant","onClick"])]),_:1}),x.value.length<3?(c(),d("div",Q,[X,e("input",{id:"file-upload",type:"file",class:"block w-full border border-gray-300 rounded-lg p-2",accept:".jpeg, .jpg, .png, .webp",onChange:I},null,32)])):F("",!0),e("div",Y,[e("p",null,[Z,B(" "+u((h=r.value)==null?void 0:h.id),1)]),e("p",null,[ee,B(" "+u((y=r.value)==null?void 0:y.username),1)])]),e("div",te,[e("h2",se," RizzRates ("+u(D(w))+" reviews) ",1),k(v,{"read-only":!0,"rating-size":24,"rating-value":p.value,"border-color":"#db8403","active-color":"#ffa41c","inactive-color":"#fff","rating-step":.5,"rounded-corners":!0,"rating-level":10,"rating-count":10,"border-width":5},null,8,["rating-value"]),e("h3",ae,u(p.value.toFixed(2))+" out of 10 stars ",1)]),e("div",oe,[i.value?(c(),d("div",le," Error: "+u(i.value),1)):z.value?(c(),d("div",ne," Images uploaded successfully! ")):F("",!0)])])]),e("div",re,[ie,e("div",ce,[(c(!0),d(S,null,G(b.value,(a,s)=>(c(),d("div",{key:s,class:"p-4 bg-white rounded-lg shadow"},[e("p",null,u(a),1)]))),128))])])])])])}}});export{fe as default};
